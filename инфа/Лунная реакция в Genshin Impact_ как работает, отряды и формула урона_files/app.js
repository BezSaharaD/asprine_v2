$(document).ready(function(){$('.search-btn').on('click',function(event){$('.search-box').css('display','block').animate({'top':'0'},350);$('#story').focus();$('body').prepend('<div id="dark-knight"><div></div></div>');$('#dark-knight').css('display','block').animate({'opacity':'1'},400)});$('.search-btn-close').on('click',function(event){$('#searchsuggestions').fadeOut(300);$('.q-search-cats ul').animate({'opacity':'0','top':'66px'},300,function(){$('.q-search-cats ul').css('display','none');$('.q-sch-btn').removeClass('qsch-close')});$('.search-box').animate({'top':'-70px'},200,function(){$(this).css('display','none')});$('#dark-knight').animate({'opacity':'0'},300,function(){$(this).remove()})});$('.q-sch-btn').on('click',function(event){if($(this).hasClass('qsch-close')){$('.q-search-cats ul').animate({'opacity':'0','top':'66px'},300,function(){$('.q-search-cats ul').css('display','none');$('.q-sch-btn').removeClass('qsch-close')})}else{$('.q-search-cats ul').css('display','block');$('.q-search-cats ul').animate({'opacity':'1','top':'52px'},300);$(this).addClass('qsch-close')}});$('.sch-btn').on('click',function(event){if($(this).hasClass('qsch-close')){$('.search-cats select').animate({'opacity':'0','top':'60px'},300,function(){$('.search-cats select').css('display','none');$('.sch-btn').removeClass('qsch-close')})}else{$('.search-cats select').css('display','block');$('.search-cats select').animate({'opacity':'1','top':'50px'},300);$(this).addClass('qsch-close')}});$('.login-btn').on('click',function(event){$('.login-area').css('display','flex').animate({'opacity':'1'},500)});$('.login-area').click(function(event){if($(event.target).hasClass('login-area')){$(this).animate({'opacity':'0'},300,function(){$(this).css('display','none')})}});$('.login-close').click(function(){$('.login-area').animate({'opacity':'0'},300,function(){$(this).css('display','none')})});$('.info-area').click(function(){if($(event.target).hasClass('info-area')){$(this).animate({'opacity':'0'},300,function(){$(this).css('display','none')})}});$('.info-close').click(function(){$('.info-area').animate({'opacity':'0'},300,function(){$(this).css('display','none')})});$('.profile-btn').on('click',function(event){if($(this).hasClass('pro-close')){$('.profile-btn').removeClass('pro-close');$('.profile-box').animate({'opacity':'0','top':'15px'},300,function(){$('.profile-area').css('display','none')})}else{$('.profile-area').css('display','block');$('.profile-box').animate({'opacity':'1','top':'2px'},300);$(this).addClass('pro-close')}});$(document).mouseup(function(e){var div=$(".profile-area");if(!div.is(e.target)&&div.has(e.target).length===0&&$('.profile-btn').hasClass('pro-close')){$('.profile-box').animate({'opacity':'0','top':'15px'},300,function(){$('.profile-area').css('display','none');$('.profile-btn').removeClass('pro-close')})}});$('.smart-extra-btn').on('click',function(event){if($(this).hasClass('open')){$('.smart-extra').animate({'bottom':'-50px'},200);$('.smart-extra-btn').removeClass('open')}else{$('.smart-extra').animate({'bottom':'0'},200);$(this).addClass('open')}});$(document).on('mouseup',function(e){var smart_extra=$(".smart-extra");if(!smart_extra.is(e.target)&&smart_extra.has(e.target).length===0&&$('.smart-extra-btn').hasClass('open')){smart_extra.animate({'bottom':'-50px'},200,function(){$('.smart-extra-btn').removeClass('open')});$('.soc-mbl .social').css('display','none');$('.soc-mbl-btn').removeClass('open')}});$('.soc-mbl-btn').on('click',function(event){if($(this).hasClass('open')){$('.soc-mbl .social').animate({'opacity':'0'},200,function(){$(this).css('display','none')});$('.soc-mbl-btn').removeClass('open')}else{$('.soc-mbl .social').css('display','flex').animate({'opacity':'1'},200);$(this).addClass('open')}});$('.close-content-bnt').on('click',function(){$('#content-box-mbl').animate({'right':'-320px'},250,function(){$(this).css('display','none')});$('.on-art-content').removeClass('open')});$('body').on('click','#dark-knight, .mbl-menu-close',function(event){$('.mbl-menu-box').animate({'right':'-250'},300,function(){$(this).css('display','none')});$('.search-box').animate({'top':'-70px'},200,function(){$(this).css('display','none')});$('.login-area').css('display','none');$('.q-search-cats ul').animate({'opacity':'0','top':'66px'},300,function(){$('.q-search-cats ul').css('display','none');$('.q-sch-btn').removeClass('qsch-close')});$('#searchsuggestions').fadeOut(300);$('body').removeClass('fix');$('#dark-knight').animate({'opacity':'0'},300,function(){$(this).remove()})});$('body').on('click','#searchsuggestions',function(e){if($(e.target).attr('id')=='searchsuggestions'){$('#searchsuggestions').fadeOut(300);$('.q-search-cats ul').animate({'opacity':'0','top':'66px'},300,function(){$('.q-search-cats ul').css('display','none');$('.q-sch-btn').removeClass('qsch-close')});$('.search-box').animate({'top':'-70px'},200,function(){$(this).css('display','none')});$('#dark-knight').animate({'opacity':'0'},300,function(){$(this).remove()})}});$('#light-knight').on('click',function(event){$('body').removeClass('fix');$('#light-knight').remove()});$('#platforms-menu label span').on('click',function(event){$('#platforms-menu > span').remove();$(this).clone().prependTo($('#platforms-menu'))});$('#sorting-menu label span').on('click',function(event){$('#sorting-menu > span').remove();$(this).clone().prependTo($('#sorting-menu'))});$('#rating-menu label span').on('click',function(event){$('#rating-menu > span').text('Мин. оценка: ');$(this).clone().appendTo($('#rating-menu > span'))});$('#category-menu label span').on('click',function(event){$('#category-menu > span').remove();$(this).clone().prependTo($('#category-menu'))});$('#genres-menu label span').on('click',function(event){$('#genres-menu > span').remove();$(this).clone().prependTo($('#genres-menu'))});$('.plus-btn').on('click',function(){$(this).toggleClass('rated');$(this).siblings('.minus-btn').removeClass('rated')});$('.minus-btn').on('click',function(){$(this).toggleClass('rated');$(this).siblings('.plus-btn').removeClass('rated')});$(document).on("click",".pluscom-btn",function(){$(this).toggleClass('rated');$(this).siblings('.minuscom-btn').removeClass('rated')});$(document).on("click",".minuscom-btn",function(){$(this).toggleClass('rated');$(this).siblings('.pluscom-btn').removeClass('rated')});$('.btn-plus').on('click',function(){$(this).toggleClass('rated');$(this).siblings('.btn-minus').removeClass('rated')});$('.btn-minus').on('click',function(){$(this).toggleClass('rated');$(this).siblings('.btn-plus').removeClass('rated')});$('.soc-log a, .soc-com a').on('click',function(){var href=$(this).attr('href');var width=820;var height=420;var left=(screen.width-width)/2;var top=(screen.height-height)/2-100;auth_window=window.open(href,'auth_window',"width="+width+",height="+height+",top="+top+",left="+left+"menubar=no,resizable=no,scrollbars=no,status=no,toolbar=no");return!1});$(document).on("mouseover",".side-game",function(){$('.side-game').not(this).stop().animate({opacity:.7},400);$(this).stop().animate({opacity:1},400)});$(document).on("mouseout",".side-game",function(){$('.side-game').stop().animate({opacity:1},400)});$(document).on("mouseover",".social-btns",function(){$('.social-btns .social').stop().css('display','block').animate({opacity:1},300)});$(document).on("mouseout",".social-btns",function(){$('.social-btns .social').stop().animate({opacity:0},300,function(){$('.social-btns .social').css('display','none')})});$(document).on("mouseover",".content-post-area",function(){$('.content-box').stop().css('display','block').animate({opacity:1},300)});$(document).on("mouseout",".content-post-area",function(){$('.content-box').stop().animate({opacity:0},300,function(){$('.content-box').css('display','none')})});$(document).ready(function(){if($('.text-wrap .text').height()>300){$('.text-next').css('display','flex')}});$(document).on('click','.text-next',function(){$('.text-wrap').css('max-height','none');$('.text-next').css('display','none')});$(document).on('click','.spoiler_case',function(e){if(e.target==this){if($(this).hasClass('open')){$(this).removeClass('open')}else{$(this).addClass('open')}}})});const videos=document.querySelectorAll('.youtube-lazy');let generateUrl=function(id){let query='?rel=0&showinfo=0&autoplay=1';return'https://www.youtube.com/embed/'+id+query};let createIframe=function(id){let iframe=document.createElement('iframe');iframe.setAttribute('allowfullscreen','');iframe.setAttribute('allow','autoplay; encrypted-media');iframe.setAttribute('src',generateUrl(id));return iframe};videos.forEach((el)=>{let videoId=el.getAttribute('data-youtubeid');let img=el.querySelector('img');let youtubeImgSrc='https://i.ytimg.com/vi/'+videoId+'/maxresdefault.jpg';img.setAttribute('src',youtubeImgSrc);el.addEventListener('click',(e)=>{e.preventDefault();let iframe=createIframe(videoId);el.querySelector('img').remove();el.appendChild(iframe);el.querySelector('button').remove()})});$(document).on('click','.main-content .field-search-btn .nextajax',function(){var $this=$(this),$blockSearch=$(this).parents('.grid-search'),next_url=$this.next().attr('href')?$this.next().attr('href'):!1;if(next_url!=!1){$this.append('<div class="showloadarea"><div></div></div>');$.ajax({type:'POST',url:next_url,success:function(data){$this.parent().remove();if($('.main-content > .grid').length>0){$('.grid-search').append($('.main-content > .grid',data).html())}else{$('.grid-search').append($('.main-content > .grid-search',data).html())}
var check_url=$blockSearch.find('.nextajax').next().attr('href')?$blockSearch.find('.nextajax').next().attr('href'):!1;if(check_url==!1)$blockSearch.children('.field-search-btn').remove();},dataType:'html'})}
return!1});$(document).on('click','[data-tabgamekey] > span:not(.lbl-noposts)',function(){var $this=$(this),$filtertype='gamepage',$thisID=$this.attr('id'),$blockTab='#tab-'+$thisID,$blockGreed='#tab-'+$thisID,$blockState=$this.data('tab-state'),$blockGamekey=$this.parent().data('tabgamekey'),$blockTabCat=$this.data('tab-cat'),$tabCount=$this.children('.total-count').text(),$postID=$this.data('post-id');if($thisID=='video')$videotab=1;else $videotab=0;if($thisID=='screenshots')$filtertype='gamescreens',$blockGreed='#tab-'+$thisID+'';$('#'+$thisID).data('tab-state','0');if($blockState=='1'){$this.append('<div class="linesloadarea"><div></div></div>');$.ajax({url:dle_root+'engine/ajax/controller.php',dataType:'html',data:{mod:'extrafilter',filtertype:$filtertype,gamekey:$blockGamekey,videotab:$videotab,catstab:$blockTabCat,postcount:$tabCount,postid:$postID,user_hash:dle_login_hash}}).done(function(data){$this.find('.linesloadarea').remove();$($blockGreed).html($(data));$($blockTab).removeClass('tab-close').siblings().addClass('tab-close');$($this).addClass('active-tab').siblings().removeClass('active-tab');history.replaceState(null,null,'#tab='+$thisID+'');$(window).lazyLoadXT()}).fail(function(){ShowLoading('Материалов нет');HideLoading('');console.log("error")})}else{$($blockTab).removeClass('tab-close').siblings().addClass('tab-close');$($this).addClass('active-tab').siblings().removeClass('active-tab');history.replaceState(null,null,'#tab='+$thisID+'')}});$(document).ready(function(){if(window.location.href.indexOf("#tab=news")>-1){$("#news").trigger('click')}
if(window.location.href.indexOf("#tab=articles")>-1){$("#articles").trigger('click')}
if(window.location.href.indexOf("#tab=guides")>-1){$("#guides").trigger('click')}
if(window.location.href.indexOf("#tab=walks")>-1){$("#walks").trigger('click')}
if(window.location.href.indexOf("#tab=video")>-1){$("#video").trigger('click')}
if(window.location.href.indexOf("#tab=screenshots")>-1){$("#screenshots").trigger('click')}
if(window.location.href.indexOf("#tab=cheats")>-1){$("#cheats").trigger('click')}});$(document).ready(function(){if(window.location.href.indexOf("#tab=usergames")>-1){$("#usergames").trigger('click')}
if(window.location.href.indexOf("#tab=userposts")>-1){$("#userposts").trigger('click')}
if(window.location.href.indexOf("#tab=usercomms")>-1){$("#usercomms").trigger('click')}
if(window.location.href.indexOf("#tab=useroptions")>-1){$("#useroptions").trigger('click')}
if(window.location.href.indexOf("#tab=userprofile")>-1){$("#useroptions").trigger('click');$("#userprofile").trigger('click')}
if(window.location.href.indexOf("#tab=userinform")>-1){$("#useroptions").trigger('click');$("#userinform").trigger('click')}
if(window.location.href.indexOf("#tab=usernotice")>-1){$("#useroptions").trigger('click');$("#usernotice").trigger('click')}
if(window.location.href.indexOf("#tab=usersecurity")>-1){$("#useroptions").trigger('click');$("#usersecurity").trigger('click')}
$('#usr_games_btn').on('click',function(){$("#usergames").trigger('click')});$('#usr_opt_btn').on('click',function(){$("#useroptions").trigger('click')})});$(document).on('click','.search-head-btn',function(event){event.preventDefault();var $this=$(this),$next=$('.game-search-box'),className='search-hide';if($next.stop().hasClass(className)){$next.slideDown('300',function(){$next.removeClass(className)});$('.search-head-btn > i').remove();$('<i class="icon-minus"></i>').appendTo('.search-head-btn')}else{$next.stop().slideUp('300',function(){$next.addClass(className)});$('.search-head-btn > i').remove();$('<i class="icon-plus"></i>').appendTo('.search-head-btn')}});$(document).ready(function(){if(window.location.href.indexOf("#search")>-1){$(".search-head-btn").trigger('click')}});$(document).on('click','#fast_search_games',function(){$("#dark-knight").trigger('click');$(".search-head-btn").trigger('click')});$(document).on('click','.game-sch-chks label',function(event){var $li=$(this).parent('li'),$inputID='#'+$(this).attr('for');$li.toggleClass('checked');$li.siblings('li').removeClass('checked');$($inputID).siblings('input').prop('checked',!1)});var game_search_delay=!1;var gamename_value='';var developer_value='';var publisher_value='';function FastGameSearch(){$('#qsgame-name').keyup(function(){var inputGamename=$(this).val();if(gamename_value!=inputGamename&&(inputGamename.length>=3||inputGamename.length==0)){clearInterval(game_search_delay);game_search_delay=setInterval(function(){gamesearch()},250)}});$('#developer').keyup(function(){var inputDeveloper=$(this).val();if(developer_value!=inputDeveloper&&(inputDeveloper.length>=3||inputDeveloper.length==0)){clearInterval(game_search_delay);game_search_delay=setInterval(function(){gamesearch()},250)}});$('#publisher').keyup(function(){var inputPublisher=$(this).val();if(publisher_value!=inputPublisher&&(inputPublisher.length>=3||inputPublisher.length==0)){clearInterval(game_search_delay);game_search_delay=setInterval(function(){gamesearch()},250)}});$('.game-sch-chks input').change(function(){gamesearch()});$('#game-year').change(function(){clearInterval(game_search_delay);game_search_delay=setInterval(function(){gamesearch()},500)})};var back_url=window.location.pathname;var back_title=document.title;$('#game-sch-submit').on('click',function(){gamesearch()});function gamesearch(){clearInterval(game_search_delay);var $filtertype='gamesearch',$gamename=$('#qsgame-name').val(),$developer=$('#developer').val(),$publisher=$('#publisher').val(),$platforms=$("input[type=checkbox][name=platforms]:checked").val(),$genres=$("input[type=checkbox][name=genres]:checked").val(),$gametype=$("input[type=checkbox][name=gametype]:checked").val(),$years_slider=$("#game-year").data("ionRangeSlider"),$years_from=$years_slider.result.from,$years_to=$years_slider.result.to,$years_min=$years_slider.options.min,$years_max=$years_slider.options.max;$.ajax({url:dle_root+'engine/ajax/controller.php',dataType:'html',data:{mod:'extrafilter',filtertype:$filtertype,gamename:$gamename,developer:$developer,publisher:$publisher,platforms:$platforms,genres:$genres,gametype:$gametype,years_from:$years_from,years_to:$years_to,years_min:$years_min,years_max:$years_max,user_hash:dle_login_hash}}).done(function(data){$('.main-content').html($(data))}).fail(function(){ShowLoading('Материалов нет');HideLoading('');console.log("error")});gamename_value=$gamename;developer_value=$developer;publisher_value=$publisher};$('[data-gamesearch="reset"]').on('click',function(){var slider=$("#game-year").data("ionRangeSlider");$('.game-sch-txt input').val('');$('.game-sch-chks input').prop('checked',!1);$('.game-sch-chks li').removeClass('checked');slider.update({from:slider.options.min,to:slider.options.max});gamesearch()});FastGameSearch();$(document).on('click','.q-search-cats label',function(event){var $li=$(this).parent('li'),$inputID='#'+$(this).attr('for');$li.toggleClass('checked');$li.siblings('li').removeClass('checked');$($inputID).siblings('input').prop('checked',!1)});$(document).ready(function(){var updownareaElem=document.getElementById('updown-area');var updownElem=document.getElementById('updown');var pageYLabel=0;updownareaElem.onclick=function(){var pageY=window.pageYOffset||document.documentElement.scrollTop;switch(updownElem.className){case 'up':pageYLabel=pageY;window.scrollTo(0,0);updownElem.className='down';break;case 'down':window.scrollTo(0,pageYLabel);updownElem.className='up'}}
window.onscroll=function(){var pageY=window.pageYOffset||document.documentElement.scrollTop;var innerHeight=document.documentElement.clientHeight;switch(updownElem.className){case '':if(pageY>innerHeight){updownareaElem.className='active';updownElem.className='up'}
break;case 'up':if(pageY<innerHeight){updownareaElem.className='';updownElem.className=''}
break;case 'down':if(pageY>innerHeight){updownareaElem.className='active';updownElem.className='up'}
break}}});$(document).on('click','[data-user-tab]',function(){var back_url=window.location.pathname,$this=$(this),$thisID=$(this).attr('id'),$blockTabID=$(this).data('user-tab'),$blockTab=$('#'+$blockTabID);$($blockTab).removeClass('tab-close').siblings().addClass('tab-close');$($this).addClass('active-tab').siblings().removeClass('active-tab');history.replaceState(null,null,'#tab='+$thisID+'')});$(document).on('click','[data-user-opt]',function(){var back_url=window.location.pathname,$this=$(this),$thisID=$(this).attr('id'),$blockTabID=$(this).data('user-opt'),$blockTab=$('#'+$blockTabID);$($blockTab).removeClass('tab-close').siblings().addClass('tab-close');$($this).addClass('active-opt').siblings().removeClass('active-opt');history.replaceState(null,null,'#tab='+$thisID+'')});var thisUrl=window.location.pathname;$(document).on('click','[data-page-num]',function(event){$(this).css('pointer-events','none');var $this=$(this),blockId=$this.parent().data('blockId'),$blockNav=$this.parent(),pageNum=$this.data('pageNum'),$block=$('#'+blockId),$blockFade=$('#'+blockId+' .fadein');if($block.hasClass('fade')){$blockFade.animate({opacity:0},200,function(){$.ajax({url:dle_root+'engine/ajax/controller.php',dataType:'html',data:{mod:'blockpro',pageNum:pageNum,blockId:blockId,thisUrl:thisUrl}}).done(function(data){$block.html($(data).html());$(window).lazyLoadXT()}).fail(function(){$('#'+blockId+' .fadein').animate({opacity:1},200);console.log("error")}).always(function(){$('#'+blockId+' .fadein').animate({opacity:1},200)})})}else{$this.append('<div class="showloadarea"><div></div></div>');$.ajax({url:dle_root+'engine/ajax/controller.php',dataType:'html',data:{mod:'blockpro',pageNum:pageNum,blockId:blockId,thisUrl:thisUrl}}).done(function(data){$($blockNav).remove();$($block).append($(data).html());$(window).lazyLoadXT();if($block.hasClass('event-news')){$(document).ready(function(){$('.pgwSlideshowLight').pgwSlideshow();$('.pgwSlideshowLight').css('opacity','1')})}}).fail(function(){base_loader(blockId,'stop');console.log("error")}).always(function(){base_loader(blockId,'stop')})}}).on('click','[data-favorite-id]',function(event){event.preventDefault();var $this=$(this),fav_id=$this.data('favoriteId'),action=$this.data('action');$.get(dle_root+'engine/ajax/controller.php',{fav_id:fav_id,action:action,skin:dle_skin,mod:'favorites',alert:1,user_hash:dle_login_hash||''},function(data){if($this.hasClass('fav-plus')){$this.data('action','minus');$this.removeClass('fav-plus');$this.addClass('fav-minus');$this.prop('title','Отписаться')}else{$this.data('action','plus');$this.removeClass('fav-minus');$this.addClass('fav-plus');$this.prop('title','Подписаться')}})});function base_loader(id,method,className){var $block=$('#'+id),cname=(className)?className:'base-loader';if(method=='start'){$block.addClass(cname)};if(method=='stop'){$block.removeClass(cname)}}
function number_format(number,decimals,dec_point,thousands_sep){number=(number+'').replace(/[^0-9+\-Ee.]/g,'');var n=!isFinite(+number)?0:+number,prec=!isFinite(+decimals)?0:Math.abs(decimals),sep=(typeof thousands_sep==='undefined')?',':thousands_sep,dec=(typeof dec_point==='undefined')?'.':dec_point,s='',toFixedFix=function(n,prec){var k=Math.pow(10,prec);return''+(Math.round(n*k)/k).toFixed(prec)};s=(prec?toFixedFix(n,prec):''+Math.round(n)).split('.');if(s[0].length>3){s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,sep)}
if((s[1]||'').length<prec){s[1]=s[1]||'';s[1]+=new Array(prec-s[1].length+1).join('0')}
return s.join(dec)}
function base_rate(rate,id){$.get(dle_root+'engine/ajax/controller.php?mod=rating',{go_rate:rate,news_id:id,skin:dle_skin,user_hash:dle_login_hash||''},function(data){HideLoading('');if(data.success){var rating=data.ratingNumber;var votenum=data.votenum;var gamerating=(votenum/2+rating/2)/votenum*10;if(votenum==0){gamerating='n/a'}else if(gamerating>=10){gamerating=gamerating}else{gamerating=number_format(gamerating,1,'.','')}
if(gamerating<4){$('[data-rating-layer="'+id+'"]').html(gamerating).parent().removeClass('aver-rate high-rate').addClass('low-rate');$("#usr-rate-bar").val(gamerating)}else if(gamerating>=7){$('[data-rating-layer="'+id+'"]').html(gamerating).parent().removeClass('low-rate aver-rate').addClass('high-rate');$("#usr-rate-bar").val(gamerating)}else if(gamerating>=4&&gamerating<7){$('[data-rating-layer="'+id+'"]').html(gamerating).parent().removeClass('low-rate high-rate').addClass('aver-rate');$("#usr-rate-bar").val(gamerating)}else{$('[data-rating-layer="'+id+'"]').html(gamerating).parent().removeClass('low-rate aver-rate high-rate');$("#usr-rate-bar").val(gamerating)}
$('[data-vote-num-id="'+id+'"]').html(votenum);$("#ratig-layer-"+id).html(gamerating);$("#vote-num-id-"+id).html(votenum)}else if(data.error){DLEalert_new(data.errorinfo,dle_info)}},"json")};$(document).ready(function(){if(window.location.href.indexOf("#platform=")>-1||window.location.href.indexOf("#genre=")>-1||window.location.href.indexOf("#gametype=")>-1||window.location.href.indexOf("#developer=")>-1||window.location.href.indexOf("#publisher=")>-1){var $currentURL=window.location.href,$decodedUri=decodeURIComponent($currentURL),$matches=$decodedUri.match(/(#)(\w*?)(=)(.*)/),$key=$matches[2],$keyID="#"+$key,$value=decodeURIComponent($matches[4]),$label='[data-option="'+$value+'"]';if($key=='developer'||$key=='publisher'){$($keyID).val($value);$(".search-head-btn").trigger('click');gamesearch()}else{$(".search-head-btn").trigger('click');$($label).trigger('click');gamesearch()}}});$(document).ready(function(){$('.notice-btn').on('click',function(event){if($(this).hasClass('note-close')){$('.notice-btn').removeClass('note-close');$('.pm-inform-list').animate({'opacity':'0','top':'54px'},300,function(){$('.pm-inform-list').css('display','none')})}else{var $this=$(this),$pmshow=$(this).data('pm-show')?$(this).data('pm-show'):!1;$('.pm-inform-list').css('display','flex');$('.pm-inform-list').animate({'opacity':'1','top':'41px'},300);$(this).addClass('note-close');if($pmshow!=!1){$('.pm-inform-list ul').append('<div class="loading-area"><i class="icon-spin4"></i></div>');$.ajax({url:dle_root+'engine/ajax/controller.php',dataType:'html',data:{mod:'notifications',nots_action:'show_nots',user_hash:dle_login_hash}}).done(function(data){$($this).removeAttr('data-pm-show').removeData();$('.pm-inform-list ul').children('.loading-area').remove();$('.pm-inform-list ul').append(data)})}}});$(document).mouseup(function(e){var div=$(".pm-inform-list");if(!div.is(e.target)&&div.has(e.target).length===0&&$('.notice-btn').hasClass('note-close')){$('.pm-inform-list').animate({'opacity':'0','top':'54px'},300,function(){$('.pm-inform-list').css('display','none');$('.notice-btn').removeClass('note-close')})}})});$(document).on('click','.pm-ajax',function(event){var $this=$(this),$pmID=$this.data('id-pm')?$this.data('id-pm'):!1,$newsID=$this.data('id-post')?$this.data('id-post'):!1,$commID=$this.data('id-comm')?$this.data('id-comm'):!1;if($pmID!=!1){$.ajax({url:dle_root+'engine/ajax/controller.php',dataType:'html',data:{mod:'notifications',nots_action:'delete_nots',pmdeleteact:'deleteonepm',pmid:$pmID,user_hash:dle_login_hash}}).done(function(data){if($commID!=!1){var $link='/index.php?newsid='+$newsID+'#comment-id='+$commID;window.location.href=$link}else{var $link='/index.php?newsid='+$newsID;window.location.href=$link}})}})
$(document).on('click','.pmdelbtn',function(event){var $this=$(this),$pmID=$this.data('id-pm')?$this.data('id-pm'):!1,$lisubj=$this.parent('.pm-inform-subj'),$notesup=$('.notice-btn sup').text(),$notecount=parseInt($notesup)-1;if($pmID!=!1){$.ajax({url:dle_root+'engine/ajax/controller.php',dataType:'html',data:{mod:'notifications',nots_action:'delete_nots',pmdeleteact:'deleteonepm',pmid:$pmID,user_hash:dle_login_hash}}).done(function(data){if($notecount!=0){$lisubj.slideUp();$('.notice-btn sup').text($notecount);$('.note-footer a').text('Все уведомления ('+$notecount+')')}else{$lisubj.slideUp();$('.notice-btn sup').remove();$('.notice-btn').removeClass('notice-check');$('.note-footer').remove();$('.pm-inform-list ul').append('<li class="pm-inform-empty">Уведомлений нет</li>')}})}})
$(document).on('click','[data-pm-user]',function(event){var $this=$(this),$pmUsr=$this.data('pm-user')?$this.data('pm-user'):!1,$pmfooter=$this.parents('.note-footer'),$pmlist=$this.parents('.pm-inform-list'),$pminf=$this.parents('.pm-inform');if($pmUsr!=!1){$this.prepend('<i class="icon-spin4"></i>');$.ajax({url:dle_root+'engine/ajax/controller.php',dataType:'html',data:{mod:'notifications',nots_action:'delete_nots',pmdeleteact:'deleteallpms',pmdelusr:$pmUsr,user_hash:dle_login_hash}}).done(function(data){$pmlist.find('ul').remove();$pmfooter.remove();$pmlist.append('<ul><li class="pm-inform-empty">Уведомлений нет</li></ul>');$pminf.find('.notice-btn').removeClass('notice-check');$pminf.find('sup').remove()})}})
$(document).on('click','.pm-ajax-page .pm-ajax-link',function(event){var $this=$(this).parent('.pm-ajax-page'),$pmID=$this.data('id-pm')?$this.data('id-pm'):!1,$newsID=$this.data('id-post')?$this.data('id-post'):!1,$commID=$this.data('id-comm')?$this.data('id-comm'):!1;if($pmID!=!1){$.ajax({url:dle_root+'engine/ajax/controller.php',dataType:'html',data:{mod:'notifications',nots_action:'delete_nots',pmdeleteact:'deleteonepm',pmid:$pmID,user_hash:dle_login_hash}}).done(function(data){if($commID!=!1){var $link='/index.php?newsid='+$newsID+'#comment-id='+$commID;window.location.href=$link}else{var $link='/index.php?newsid='+$newsID;window.location.href=$link}})}})
$(document).on('click','.pmdelpage',function(event){var $this=$(this),$pmID=$this.data('id-pm')?$this.data('id-pm'):!1,$lisubj=$this.parents('.pm-subj-page'),$notesup=$('.notice-btn sup').text(),$notecount=parseInt($notesup)-1;if($pmID!=!1){$.ajax({url:dle_root+'engine/ajax/controller.php',dataType:'html',data:{mod:'notifications',nots_action:'delete_nots',pmdeleteact:'deleteonepm',pmid:$pmID,user_hash:dle_login_hash}}).done(function(data){if($notecount!=0){$lisubj.slideUp();$('.cat-title').text('Уведомления ('+$notecount+')');$('.notice-btn sup').text($notecount);$('.note-footer a').text('Все уведомления ('+$notecount+')')}else{$lisubj.slideUp();$('.cat-title').text('Уведомления');$('.notice-btn sup').remove();$('.notice-btn').removeClass('notice-check');$('.note-footer').remove();$('.pm-inform-page ul').append('<li class="pm-empty-page">Уведомлений нет</li>')}})}})
$(document).on('click','[data-delete-pm]',function(event){var $this=$(this),$pmUsr=$this.data('delete-pm')?$this.data('delete-pm'):!1,$pmcol=$this.parents('.col-2-3'),$pminform=$pmcol.find('.pm-inform-page'),$pmul=$pmcol.find('.pm-list-page');if($pmUsr!=!1){$this.prepend('<i class="icon-spin4"></i>');$.ajax({url:dle_root+'engine/ajax/controller.php',dataType:'html',data:{mod:'notifications',nots_action:'delete_nots',pmdeleteact:'deleteallpms',pmdelusr:$pmUsr,user_hash:dle_login_hash}}).done(function(data){$pmul.remove();$pminform.append('<ul><li class="pm-empty-page">Уведомлений нет</li></ul>');$('.cat-title').text('Уведомления');$this.find('.icon-spin4').remove();$this.removeAttr('data-delete-pm').removeData();$('.note-footer').remove();$('.pm-inform .notice-btn').removeClass('notice-check');$('.pm-inform sup').remove()})}})
$(document).on('click','#com-link',function(event){var $comtitle=$('#title-com').offset().top-75;$('html, body').scrollTop($comtitle)});$(document).ready(function(){if(window.location.href.indexOf("#coms")>-1){var $comtitle=$('#title-com').offset().top-75;$('html, body').scrollTop($comtitle)}});$(document).on('click','.com-parent',function(event){var $comparent=$(this).parents('li:eq(1)').children('div'),$comparentoff=$comparent.offset().top-75;$("HTML, BODY").animate({scrollTop:$comparentoff},500);$comparent.addClass('parent-blink')});$(document).ready(function(){$('.closetree').each(function(){var $indcount=$(this).find('.comment').length;$(this).children('.opentree-btn').addClass('count').append(' ('+$indcount+')')})});$(document).ready(function(){$(document).on("click",".tree-btn",function(){var $indcount=$(this).parent('.comments-tree-list').find('.comment').length;$(this).parent('.comments-tree-list').addClass('closetree');if(!$(this).siblings('.opentree-btn').hasClass('count')){$(this).siblings('.opentree-btn').addClass('count').append(' ('+$indcount+')')}});$(document).on("click",".opentree-btn",function(){$(this).parent('.comments-tree-list').removeClass('closetree')})});$(document).ready(function(){$('body').on('click','.comsort div',function(){var $this=$(this),$comsort=$this.data('comsort');if(!$this.hasClass('comsortcheck')){current_comments_page=1;$('.ajax_comments_next').css('display','inline-block');$.get(dle_root+"engine/ajax/controller.php?mod=comments",{cstart:0,news_id:dle_news_id,skin:dle_skin,massact:'disable',comsort:$comsort,comsortact:'comsortchange'},function(data){$this.addClass('comsortcheck');$this.siblings().removeClass('comsortcheck');$('#dle-comments-list ol').remove();$("#dle-comments-list").prepend(data.comments).removeData();$('.closetree').each(function(){var $indcount=$(this).find('.comment').length;if(!$(this).children('.opentree-btn').hasClass('count')){$(this).children('.opentree-btn').addClass('count').append(' ('+$indcount+')')}});if(current_comments_page==total_comments_pages){$('.ajax_comments_next').css('display','none')}
$(window).lazyLoadXT();makecolorfullAva()},"json")}})});$(document).ready(function(){$('body').on('click','.ajax_comments_next',function(){$(this).css('pointer-events','none');var $this=$(this),$comsort=$('.comsortcheck').data('comsort');if(current_comments_page<total_comments_pages){current_comments_page ++;$this.append('<div class="showloadarea"><div></div></div>');$.get(dle_root+"engine/ajax/controller.php?mod=comments",{cstart:current_comments_page,news_id:dle_news_id,skin:dle_skin,massact:'disable',comsort:$comsort},function(data){$this.parent().find('.showloadarea').remove();$this.css('pointer-events','auto');$(".ajax_loaded_comments").append(data.comments);$('.closetree').each(function(){var $indcount=$(this).find('.comment').length;if(!$(this).children('.opentree-btn').hasClass('count')){$(this).children('.opentree-btn').addClass('count').append(' ('+$indcount+')')}});if(current_comments_page==total_comments_pages){$('.ajax_comments_next').css('display','none')}
$(window).lazyLoadXT();makecolorfullAva()},"json")}})});$(document).ready(function(){if(window.location.href.indexOf("#comment-id=")>-1){var $currentURL=window.location.href,$matches=$currentURL.match(/#comment-id=(\d{1,7})/);if($($matches).length>0){var $comIDlength=$('#dlemasscomments').find('#comment-id-'+$matches[1]).length,n=0;if($comIDlength<1){function comrecursion(){if(current_comments_page<total_comments_pages&&n<30){current_comments_page ++;n++;$.get(dle_root+"engine/ajax/controller.php?mod=comments",{cstart:current_comments_page,news_id:dle_news_id,skin:dle_skin,massact:'disable'},function(data){$(".ajax_loaded_comments").append(data.comments);if(current_comments_page==total_comments_pages){$('.ajax_comments_next').css('display','none')}
var $comIDlength=$('#dlemasscomments').find('#comment-id-'+$matches[1]).length;if($comIDlength>0){var $scrollnew=$('#dlemasscomments').find('#comment-id-'+$matches[1]).offset().top-75;$('#dlemasscomments').find('#comment-id-'+$matches[1]).parents('.closetree').removeClass('closetree');$('html, body').scrollTop($scrollnew);$('#dlemasscomments').find('#comment-id-'+$matches[1]).addClass('newcom-blink');$('.closetree').each(function(){var $indcount=$(this).find('.comment').length;if(!$(this).children('.opentree-btn').hasClass('count')){$(this).children('.opentree-btn').addClass('count').append(' ('+$indcount+')')}});makecolorfullAva()}else{comrecursion()}},"json")}}
comrecursion()}else{var $scrollnew=$('#dlemasscomments').find('#comment-id-'+$matches[1]).offset().top-75;$('#dlemasscomments').find('#comment-id-'+$matches[1]).parents('.closetree').removeClass('closetree');$('html, body').scrollTop($scrollnew);$('#dlemasscomments').find('#comment-id-'+$matches[1]).addClass('newcom-blink')}}}});$(document).ready(function(){if(window.location.href.indexOf("#push-newsid=")>-1){var $currentURL=window.location.href,$matches=$currentURL.match(/#push-newsid=(\d{1,7})/),$newsID='',$notesup=$('.notice-btn sup').text(),$notecount=parseInt($notesup)-1,back_url=window.location.pathname;if($($matches).length>0){var $newsID=$matches[1]}
if($newsID!=''){$.ajax({url:dle_root+'engine/ajax/controller.php',dataType:'html',data:{mod:'notifications',nots_action:'delete_push_nots',pushdelaction:'delnewspm',pushnewsid:$newsID,user_hash:dle_login_hash}}).done(function(data){if(data!=''){if($notecount!=0){$('.notice-btn sup').text($notecount);$('.note-footer a').text('Все уведомления ('+$notecount+')')}else{$('.notice-btn sup').remove();$('.notice-btn').removeClass('notice-check');$('.note-footer').remove()}}})}
window.history.replaceState(null,null,back_url)}});$(document).ready(function(){if(window.location.href.indexOf("#push-comid=")>-1){var $currentURL=window.location.href,$matches=$currentURL.match(/#push-comid=(\d{1,7})/),$comID='',$notesup=$('.notice-btn sup').text(),$notecount=parseInt($notesup)-1,back_url=window.location.pathname;if($($matches).length>0){var $comID=$matches[1],$comIDlength=$('#dlemasscomments').find('#comment-id-'+$matches[1]).length,n=0}
if($comIDlength<1){function pushrecursion(){if(current_comments_page<total_comments_pages&&n<30){current_comments_page ++;n++;$.get(dle_root+"engine/ajax/controller.php?mod=comments",{cstart:current_comments_page,news_id:dle_news_id,skin:dle_skin,massact:'disable'},function(data){$(".ajax_loaded_comments").append(data.comments);if(current_comments_page==total_comments_pages){$('.ajax_comments_next').css('display','none')}
var $comIDlength=$('#dlemasscomments').find('#comment-id-'+$matches[1]).length;if($comIDlength>0){var $scrollnew=$('#dlemasscomments').find('#comment-id-'+$matches[1]).offset().top-75;$('#dlemasscomments').find('#comment-id-'+$matches[1]).parents('.closetree').removeClass('closetree');$('html, body').scrollTop($scrollnew);$('#dlemasscomments').find('#comment-id-'+$matches[1]).addClass('newcom-blink')}else{pushrecursion()}},"json")}}
pushrecursion()}else{var $scrollnew=$('#dlemasscomments').find('#comment-id-'+$matches[1]).offset().top-75;$('#dlemasscomments').find('#comment-id-'+$matches[1]).parents('.closetree').removeClass('closetree');$('html, body').scrollTop($scrollnew);$('#dlemasscomments').find('#comment-id-'+$matches[1]).addClass('newcom-blink')}
if($comID!=''){$.ajax({url:dle_root+'engine/ajax/controller.php',dataType:'html',data:{mod:'notifications',nots_action:'delete_push_nots',pushdelaction:'delcomentpm',pushcomid:$comID,user_hash:dle_login_hash}}).done(function(data){if(data!=''){if($notecount!=0){$('.notice-btn sup').text($notecount);$('.note-footer a').text('Все уведомления ('+$notecount+')')}else{$('.notice-btn sup').remove();$('.notice-btn').removeClass('notice-check');$('.note-footer').remove()}}})}
window.history.replaceState(null,null,back_url)}});$(document).ready(function(){if(window.location.href.indexOf("#pmuserread")>-1){var $notesup=$('.notice-btn sup').text(),$notecount=parseInt($notesup)-1,$currentURL=window.location.href,$matches=$currentURL.match(/(^http.*)#pmuserread/);if($($matches).length>0){var back_url=$matches[1]}
if($notecount!=0){$('.notice-btn sup').text($notecount);$('.note-footer a').text('Все уведомления ('+$notecount+')')}else{$('.notice-btn sup').remove();$('.notice-btn').removeClass('notice-check');$('.note-footer').remove()}
window.history.replaceState(null,null,back_url)}});var Shares={title:'Поделиться',width:600,height:400,init:function(){var share=document.querySelectorAll('.social');for(var i=0,l=share.length;i<l;i++){var url=share[i].getAttribute('data-url')||location.href,title=share[i].getAttribute('data-title')||'',desc=share[i].getAttribute('data-desc')||'',el=share[i].querySelectorAll('a');for(var a=0,al=el.length;a<al;a++){var id=el[a].getAttribute('data-id');if(id)
this.addEventListener(el[a],'click',{id:id,url:url,title:title,desc:desc})}}},addEventListener:function(el,eventName,opt){var _this=this,handler=function(){_this.share(opt.id,opt.url,opt.title,opt.desc)};if(el.addEventListener){el.addEventListener(eventName,handler)}else{el.attachEvent('on'+eventName,function(){handler.call(el)})}},share:function(id,url,title,desc){url=encodeURIComponent(url);desc=encodeURIComponent(desc);title=encodeURIComponent(title);switch(id){case 'fb':this.popupCenter('https://www.facebook.com/sharer/sharer.php?u='+url,this.title,this.width,this.height);break;case 'tg':this.popupCenter('https://telegram.me/share/url?url='+url+'&text='+title,this.title,this.width,this.height);break;case 'vk':this.popupCenter('https://vk.com/share.php?url='+url+'&description='+title+'. '+desc,this.title,this.width,this.height);break;case 'tw':var text=title||desc||'';if(title.length>0&&desc.length>0)
text=title+' - '+desc;if(text.length>0)
text='&text='+text;this.popupCenter('https://twitter.com/intent/tweet?url='+url+text,this.title,this.width,this.height);break;case 'gp':this.popupCenter('https://plus.google.com/share?url='+url,this.title,this.width,this.height);break;case 'ok':this.popupCenter('https://connect.ok.ru/dk?st.cmd=WidgetSharePreview&st.shareUrl='+url,this.title,this.width,this.height);break}},newTab:function(url){var win=window.open(url,'_blank');win.focus()},popupCenter:function(url,title,w,h){var dualScreenLeft=window.screenLeft!==undefined?window.screenLeft:screen.left;var dualScreenTop=window.screenTop!==undefined?window.screenTop:screen.top;var width=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width;var height=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;var left=((width/2)-(w/2))+dualScreenLeft;var top=((height/3)-(h/3))+dualScreenTop;var newWindow=window.open(url,title,'scrollbars=yes, width='+w+', height='+h+', top='+top+', left='+left);if(window.focus){newWindow.focus()}}};$('.social a').on('click',function(){var id=$(this).data('id');if(id){var data=$(this).parent('.social');var url=data.data('url')||location.href,title=data.data('title')||'',desc=data.data('desc')||'';Shares.share(id,url,title,desc)}});var WbdContentPost=(function($){var Content=function(options){this.ui={$content:$(options.selectorContent),$subtitles:$(options.selectorSubtitles)}
this.title=options.title||'';this.minCount=options.minCountSubtitles||1000;this.hidden=options.hidden||!1;this.init()}
Content.prototype.init=function(){if(!this.ui.$content.length||this.ui.$subtitles.length<this.minCount){this.ui.$content.remove();return!1}
var contentHtml='',display=this.hidden?'none':'block';this.ui.$subtitles.each(function(n,item){var anchor='subtitle'+n,$item=$(item);if($item[0].tagName=='H2'){subtitle='<li class="h2child" data-subtitle="#subtitle'+n+'">'+$item.text()+'</li>'}else if($item[0].tagName=='H3'){subtitle='<li class="h3child" data-subtitle="#subtitle'+n+'">'+$item.text()+'</li>'}else{subtitle='<li class="h4child" data-subtitle="#subtitle'+n+'">'+$item.text()+'</li>'}
$item.attr('id',anchor);contentHtml+=subtitle});this.ui.$content.html('<ul style="display:'+display+'">'+contentHtml+'</ul>');if(this.hidden){this.ui.$content.find('li').on('click',function(){$(this).next().slideToggle(300)})}}
return Content})(jQuery);jQuery(document).ready(function(){new WbdContentPost({selectorContent:'#content-post',selectorSubtitles:'.text > h2, .text > h3',title:'',minCountSubtitles:1,hidden:!1})});$(document).ready(function(){$('body').on('click','#content-post li',function(){var $scrollid=$(this).data('subtitle'),$scrollttl=$($scrollid).offset().top-75;$('html, body').scrollTop($scrollttl)})});$(document).ready(function(){$('body').on('click','.leaflet-popup-content .subbtn',function(){var $scrollcls=$(this).data('subcls'),$scrollttl=$('.'+$scrollcls).offset().top-75;$('html, body').scrollTop($scrollttl)})});$(document).ready(function(){$('body').on('click','.tomark',function(){var $markID=$(this).data('tomark'),$markImg=$('#leafmap img[alt="'+$markID+'"]'),$scrollmap=$('#leafmap').offset().top-75;$('html, body').scrollTop($scrollmap);if(!$markImg.hasClass('open')){$('.leaflet-marker-icon').removeClass('open');$markImg.trigger('click');$markImg.addClass('open')}})});$(document).ready(function(){$(document).on('focus.autoExpand','textarea.autoExpand',function(){var savedValue=this.value;this.value='';this.baseScrollHeight=this.scrollHeight;this.value=savedValue}).on('input.autoExpand','textarea.autoExpand',function(){var minRows=this.getAttribute('data-min-rows')|0,rows;this.rows=minRows;rows=Math.ceil((this.scrollHeight-this.baseScrollHeight)/19);this.rows=minRows+rows})});$(document).ready(function(){var main_width=$('#main_art').width();var updateTables=function(){if($(window).width()>500)main_width=$('#main_art').width();else main_width=$(window).width();$("table.responsive").each(function(i,element){if($(this).width()>main_width&&!$(this).hasClass('switched')){table_scrollbar($(element))}
sticky_thead($(element))});return!0};var resizeTables=function(){if($(window).width()>500)main_width=$('#main_art').width();else main_width=$(window).width();$("table.responsive").each(function(i,element){if($(this).width()>main_width){table_scrollbar($(element))}
sticky_thead($(element))})};updateTables();var cachedWidth=$(window).width();$(window).on("resize",function(){var newWidth=$(window).width();if(newWidth!==cachedWidth){clearTimeout(window.resizedFinished);window.resizedFinished=setTimeout(function(){resizeTables()},200);cachedWidth=newWidth}});function table_scrollbar(original){original.next(".fixed-scrollbar").remove();var fixedBarTemplate='<div class="fixed-scrollbar"><div></div></div>';var fixedBarCSS={display:'none',overflowX:'auto',position:'fixed',width:'100%',bottom:0};var $container=original.parent();var $bar=$(fixedBarTemplate).appendTo($container).css(fixedBarCSS);$bar.on('scroll',function(){$container.scrollLeft($bar.scrollLeft())});$bar.data("status","off");$bar.children('div').height(1).width($container[0].scrollWidth);$bar.width($container.width()).scrollLeft($container.scrollLeft());var scrollTimeout=null;$(window).on("scroll.fixedbar",function(){clearTimeout(scrollTimeout);scrollTimeout=setTimeout(function(){var $container=original.parent();var $bar=$container.children('.fixed-scrollbar');if($bar.length){var containerOffset={top:$container.offset().top,bottom:$container.offset().top+$container.height()};var windowOffset={top:$(window).scrollTop(),bottom:$(window).scrollTop()+$(window).height()};if((containerOffset.top>windowOffset.bottom)||(windowOffset.bottom>containerOffset.bottom)){if($bar.data("status")=="on"){$bar.css('display','none').data("status","off")}}else{if($bar.data("status")=="off"){$bar.css('display','block').data("status","on");$bar.scrollLeft($container.scrollLeft())}}}},10)});$(window).trigger("scroll.fixedbar")}
function sticky_thead(table){table.prev(".th-copy-wrap").remove();var th_arr=table.find('th');var divs_names='';th_arr.each(function(i,th){divs_names+='<div style="width: '+$(th).outerWidth()+'px">'+$(th).text()+'</div>'});table.parent().prepend('<div class="th-copy-wrap" style="display: none; width: '+table.parent().width()+'px"><div class="th-copy" style="width: '+table.width()+'px">'+divs_names+'</div></div>');var thead_copy=table.prev('.th-copy-wrap');var container=table.parent();if(container){container.on('scroll',function(){thead_copy.scrollLeft(container.scrollLeft())})}
thead_copy.data("status","off");var scrollTimeout=null;$(window).on("scroll.fixedthead",function(){clearTimeout(scrollTimeout);scrollTimeout=setTimeout(function(){var $container=table.parent();var $thead_copy=$container.children('.th-copy-wrap');if($thead_copy.length){var containerOffset={top:$container.offset().top,bottom:$container.offset().top+$container.height()-50};var windowOffset={top:$(window).scrollTop()+50,bottom:$(window).scrollTop()+$(window).height()};if((containerOffset.top>windowOffset.top)||(windowOffset.top>containerOffset.bottom)){if($thead_copy.data("status")=="on"){$thead_copy.css('display','none').data("status","off")}}else{if($thead_copy.data("status")=="off"){$thead_copy.css('display','block').data("status","on");$thead_copy.scrollLeft($container.scrollLeft())}}}},10)});$(window).trigger("scroll.fixedthead")}});function dle_new_reply(id,indent,simple){var b={};var editor_mode='';var needwrap=0;$('.com-ans a:nth-child(1)').css('display','inline-block');$('.com-ans a:nth-child(2)').css('display','none');$('#comment-id-'+id+' .com-ans a:nth-child(1)').css('display','none');$('#comment-id-'+id+' .com-ans a:nth-child(2)').css('display','inline-block');$('#dlereplypopup').remove();$('#dlefastreplyesponse').remove();$('#dlefastreplycomments').remove();$("<div id='dlefastreplyesponse'></div>").insertAfter('#comment-id-'+id);needwrap=1;$.get(dle_root+"engine/ajax/controller.php?mod=replycomments",{id:id,indent:indent,skin:dle_skin,user_hash:dle_login_hash,needwrap:needwrap},function(data){if(simple!='0'){$("<div id='dlefastreplycomments' style='display: none;'></div>").insertAfter('#comment-id-'+id);$('#dlefastreplycomments').html(data);$('#dlefastreplycomments').css('display','block')}},'html');return!1};function ajax_new_cancel_reply(id){$('#dlefastreplycomments').css('display','none');$('#'+id+' .com-ans a:nth-child(2)').css('display','none');$('#'+id+' .com-ans a:nth-child(1)').css('display','inline-block')};function ajax_new_fast_reply(id,indent,needwrap){var editor_mode='';if(dle_wysiwyg=="1"||dle_wysiwyg=="2"){if(dle_wysiwyg=="2"){tinyMCE.triggerSave()}
editor_mode='wysiwyg'}
var comments=$('#comments'+id).val();var name=$('#name'+id).val();var mail='';var question_answer=$('#question_answer'+id).val();var sec_code=$('#sec_code'+id).val();var allow_subscribe=$('#subscribe'+id+':checked').val();var postid=$('#postid'+id).val();var g_recaptcha_response='';if(name==''){DLEalert_new(dle_req_field[0],dle_info);return!1}
if(comments==''){DLEalert_new(dle_req_field[1],dle_info);return!1}
if(dle_captcha_type=="1"){if(typeof grecaptcha!="undefined"){g_recaptcha_response=grecaptcha.getResponse(recaptcha_widget)}}else if(dle_captcha_type=="2"){g_recaptcha_response=$('#comments-recaptcha-response'+id).val()}
if(!allow_subscribe){allow_subscribe=0}
if(!sec_code){sec_code=''}
if(!question_answer){question_answer=''}
$('#comment-id-'+id).next('#dlefastreplycomments').find('.com-btn-wrap').append('<div class="showloadarea"><div></div></div>');$.post(dle_root+"engine/ajax/controller.php?mod=addcomments",{post_id:postid,parent:id,indent:indent,comments:comments,name:name,mail:mail,editor_mode:editor_mode,skin:dle_skin,sec_code:sec_code,question_answer:question_answer,g_recaptcha_response:g_recaptcha_response,allow_subscribe:allow_subscribe,user_hash:dle_login_hash,needwrap:needwrap},function(data){$('#comment-id-'+id).next('#dlefastreplycomments').find('.showloadarea').remove();if(data.error){$(data.content).insertBefore('#dlefastreplyesponse')}else if(data.success){if($('#comm-id-'+data.id).length){var content=$(data.content).find('#comm-id-'+data.id).html();$('#dlefastreplycomments').hide();$("html,body").stop().animate({scrollTop:$('#comm-id-'+data.id).offset().top-100},600,function(){$('#comm-id-'+data.id).fadeOut("slow",function(){$(this).html(content+'<script>'+data.scripts+'</script>');$('#comm-id-'+data.id).fadeIn("slow")})})}else{$(data.content+'<script>'+data.scripts+'</script>').insertBefore('#dlefastreplyesponse');$('#dlefastreplycomments').css('display','none');$('#comment-id-'+id+' .com-ans a:nth-child(1)').css('display','inline-block');$('#comment-id-'+id+' .com-ans a:nth-child(2)').css('display','none');$('#comments-tree-item-'+data.id).fadeIn('slow');$(window).lazyLoadXT()}
makecolorfullAva()}},'json');return!1}
function DeleteCommentsNew(id,hash){if(window.confirm("Удалить комментарий?")){$.get(dle_root+"engine/ajax/controller.php?mod=deletecomments",{id:id,dle_allow_hash:hash},function(r){r=parseInt(r);if(!isNaN(r)){var node=null;if(dle_tree_comm=='1'){node=$("#comments-tree-item-"+r)}else{node=$("#comment-id-"+r)}
setTimeout(function(){node.fadeOut('slow')},50)}})}};function ajax_new_comm_edit(c_id,area){for(var i=0,length=c_cache.length;i<length;i++){if(i in c_cache){if(c_cache[i]!=''){ajax_cancel_comm_edit(i)}}}
if(!c_cache[c_id]||c_cache[c_id]==''){c_cache[c_id]=$('#comm-id-'+c_id).html()}
$.get(dle_root+"engine/ajax/controller.php?mod=editcomments",{id:c_id,area:area,action:"edit"},function(data){$('#comm-id-'+c_id).html(data)},'html');return!1};function ajax_new_save_comm_edit(c_id,area){if(dle_wysiwyg=="2"){tinyMCE.triggerSave()}
var comm_txt=$('#dleeditcomments'+c_id).val();$('#comm-id-'+c_id).find('.com-btn-wrap').append('<div class="showloadarea"><div></div></div>');$.post(dle_root+"engine/ajax/controller.php?mod=editcomments",{id:c_id,comm_txt:comm_txt,area:area,action:"save",user_hash:dle_login_hash},function(data){c_cache[c_id]='';$("#comm-id-"+c_id).html(data)});return!1};function doNewAddComments(){var form=document.getElementById('dle-comments-form');var editor_mode='';var question_answer='';var sec_code='';var g_recaptcha_response='';var allow_subscribe="0";var mail='';if(dle_wysiwyg=="1"||dle_wysiwyg=="2"){if(dle_wysiwyg=="2"){tinyMCE.triggerSave()}
editor_mode='wysiwyg'}
if(form.name.value==''){DLEalert_new(dle_req_field[0],dle_info);return!1}
if(form.comments.value==''){DLEalert_new(dle_req_field[1],dle_info);return!1}
if(form.question_answer){question_answer=form.question_answer.value}
if(form.sec_code){sec_code=form.sec_code.value}
if(dle_captcha_type=="1"){if(typeof grecaptcha!="undefined"){g_recaptcha_response=grecaptcha.getResponse()}}else if(dle_captcha_type=="2"){g_recaptcha_response=$('#g-recaptcha-response').val()}
if(form.allow_subscribe){if(form.allow_subscribe.checked==!0){allow_subscribe="1"}}
if(form.mail){mail=form.mail.value}
$('#addcomment .com-btn-area').append('<div class="showloadarea"><div></div></div>');$.post(dle_root+"engine/ajax/controller.php?mod=addcomments",{post_id:form.post_id.value,comments:form.comments.value,name:form.name.value,mail:mail,editor_mode:editor_mode,skin:dle_skin,sec_code:sec_code,question_answer:question_answer,g_recaptcha_response:g_recaptcha_response,allow_subscribe:allow_subscribe,user_hash:dle_login_hash},function(data){$('#addcomment').find('.showloadarea').remove();if(data.error){$('#dle-ajax-comments').append(data.content)}else if(data.success){$('#no-comments').remove();if($('#comm-id-'+data.id).length){var content=$(data.content).find('#comm-id-'+data.id).html();$("html,body").stop().animate({scrollTop:$('#comm-id-'+data.id).offset().top-100},600,function(){$('#comm-id-'+data.id).fadeOut("slow",function(){$(this).html(content+'<script>'+data.scripts+'</script>');$('#comm-id-'+data.id).fadeIn("slow")})})}else{$(data.content+'<script>'+data.scripts+'</script>').insertBefore('#dle-ajax-comments');if($('#comments-tree-item-'+data.id).length){node=$("#comments-tree-item-"+data.id)}else{node=$("#blind-animation-"+data.id)}
$("html,body").stop().animate({scrollTop:$('#dle-ajax-comments').offset().top-100},600,function(){$('.comm-area .txt-login').remove();$(node).fadeIn('slow');$(window).lazyLoadXT()})}
if(form.sec_code){form.sec_code.value='';reload()}
if(dle_captcha_type=="1"){if(typeof grecaptcha!="undefined"){grecaptcha.reset()}}else if(dle_captcha_type=="2"){if(typeof grecaptcha!="undefined"){var recaptcha_public_key=$('#g-recaptcha-response').data('key');grecaptcha.execute(recaptcha_public_key,{action:'comments'}).then(function(token){$('#g-recaptcha-response').val(token)})}}
makecolorfullAva()}},'json');return!1};function doNewRate(rate,id){$.get(dle_root+"engine/ajax/controller.php?mod=rating",{go_rate:rate,news_id:id,skin:dle_skin,user_hash:dle_login_hash},function(data){if(data.success){var rating=data.rating;rating=rating.replace(/&lt;/g,"<");rating=rating.replace(/&gt;/g,">");rating=rating.replace(/&amp;/g,"&");$("#ratig-layer-"+id).html(rating);$("#vote-num-id-"+id).html(data.votenum);$("#likes-id-"+id).html(data.likes);$("#dislikes-id-"+id).html(data.dislikes)}else if(data.error){DLEalert_new(data.errorinfo,dle_info)}},"json")};function doNewCommentsRate(rate,id){$.get(dle_root+"engine/ajax/controller.php?mod=ratingcomments",{go_rate:rate,c_id:id,skin:dle_skin,user_hash:dle_login_hash},function(data){if(data.success){var rating=data.rating;rating=rating.replace(/&lt;/g,"<");rating=rating.replace(/&gt;/g,">");rating=rating.replace(/&amp;/g,"&");$("#comments-ratig-layer-"+id).html(rating);$("#comments-vote-num-id-"+id).html(data.votenum);$("#comments-likes-id-"+id).html(data.likes);$("#comments-dislikes-id-"+id).html(data.dislikes)}else if(data.error){DLEalert_new(data.errorinfo,dle_info)}},"json")};function doNewFavorites(fav_id,event,alert){$.get(dle_root+"engine/ajax/controller.php?mod=favorites",{fav_id:fav_id,action:event,skin:dle_skin,alert:alert,user_hash:dle_login_hash},function(data){if(data.success){if(alert){DLEalert_new(data.content,dle_info)}else{$("#fav-id-"+fav_id).html(data.content)}}else if(data.error){DLEalert_new(data.content,dle_info)}},"json");return!1};function CheckNewLogin(){var name=document.getElementById('name').value;$.post(dle_root+"engine/ajax/controller.php?mod=registration",{name:name,user_hash:dle_login_hash},function(data){$("#result-registration").html(data)});return!1};function dle_new_do_search(inputString,category=0){clearInterval(dle_search_delay);$('#searchsuggestions').remove();$("body").append("<div id='searchsuggestions' style='display:none'><div></div></div>");$.post(dle_root+"engine/ajax/controller.php?mod=search",{query:""+inputString+"",category:""+category+"",user_hash:dle_login_hash},function(data){$('#searchsuggestions > div').html(data);$('#searchsuggestions').fadeIn()});dle_search_value=inputString};function DLEalert_new(message,title){$(".info-area-light").remove();$("body").append("<div class='info-area-light'><div id='infopopup' class='info-dialog'><div class='info-dialog-titlebar'><div class='info-dialog-title'>"+title+"</div><div class='info-close'></div></div><div class='info-dialog-content'>"+message+"</div></div></div>")};$('body').on('click','.info-area-light',function(event){if($(event.target).hasClass('info-area-light')){$(".info-area-light").remove()}});$('body').on('click','.info-close',function(){$(".info-area-light").remove()});function ShowOrHide(id){var item=$("#"+id);var image=null;if(document.getElementById('image-'+id)){image=document.getElementById('image-'+id)}
if(jQuery().lazyLoadXT){$('#'+id+' *[data-src]').lazyLoadXT()}
var scrolltime=(item.height()/200)*1000;if(scrolltime>3000){scrolltime=3000}
if(scrolltime<250){scrolltime=250}
if(item.css("display")=="none"){item.show();if(image){image.src=dle_root+'templates/'+dle_skin+'/dleimages/spoiler-minus.gif'}}else{if(scrolltime>2000){scrolltime=2000}
item.hide();if(image){image.src=dle_root+'templates/'+dle_skin+'/dleimages/spoiler-plus.gif'}}};function AddComplaint(id,action){if(window.confirm("Отправить на проверку?")){if(action=='comments'){var response='Жалоба на комментарий'}else{var response='Жалоба'}
var entermail='';if($('#dle-promt-mail').val()){entermail=$('#dle-promt-mail').val()}
$.post(dle_root+'engine/ajax/controller.php?mod=complaint',{id:id,text:response,action:action,mail:entermail,user_hash:dle_login_hash},function(data){if(data!='ok'){DLEalert_new(data,dle_info)}})}};$(document).keydown(function(event){if(event.which==13&&event.ctrlKey){event.preventDefault();if(window.getSelection){var selectedText=window.getSelection()}else if(document.getSelection){var selectedText=document.getSelection()}else if(document.selection){var selectedText=document.selection.createRange().text}
if(selectedText==""){return!1}
if(selectedText.toString().length<3){DLEalert_new('Выделен слишком маленький участок текста',dle_info);return!1}
if(selectedText.toString().length>255){DLEalert_new(dle_big_text,dle_info);return!1}
var response_prompt=prompt("Отправить уведомление об ошибке в тексте: "+selectedText+". Правильный вариант:");if(response_prompt==null){return!1}
if(response_prompt!=''){var response=response_prompt}else{var response='---'}
var selectedText=selectedText.toString();var entermail='';$.post(dle_root+'engine/ajax/controller.php?mod=complaint',{seltext:selectedText,text:response,mail:entermail,user_hash:dle_login_hash,action:"orfo",url:window.location.href},function(data){if(data!='ok'){DLEalert_new(data,dle_info)}})}});var c_cache=[],dle_poll_voted=[];function reload(){var e=(new Date).getTime();document.getElementById("dle-captcha").innerHTML='<img src="'+dle_root+"engine/modules/antibot/antibot.php?rndval="+e+'" width="160" height="80" alt="" />'}function dle_change_sort(e,o){var t=document.getElementById("news_set_sort");return t.dlenewssortby.value=e,t.dledirection.value=o,t.submit(),!1}function doPoll(e,o){var t=document.getElementById("dlepollform_"+o),i=t.status.value,n="";if(1!=dle_poll_voted[o]){if("results"!=e&&1!=i){for(var d=0;d<t.elements.length;d++){var l=t.elements[d];if("radio"==l.type&&1==l.checked){n=l.value;break}"checkbox"==l.type&&1==l.checked&&(n=n+l.value+" ")}if("vote"==e&&""==n)return;dle_poll_voted[o]=1}else i=1,t.status.value=1;1==i&&"vote"==e&&(i=0,t.status.value=0,e="list"),ShowLoading(""),$.post(dle_root+"engine/ajax/controller.php?mod=poll",{news_id:o,action:e,answer:n,dle_skin:dle_skin,user_hash:dle_login_hash},function(e){HideLoading(""),$("#dle-poll-list-"+o).fadeOut(500,function(){$(this).html(e),$(this).fadeIn(500)})})}}function IPMenu(e,o,t,i){var n=[];return n[0]='<a href="https://www.nic.ru/whois/?searchWord='+e+'" target="_blank">'+o+"</a>",n[1]='<a href="'+dle_root+dle_admin+"?mod=iptools&ip="+e+'" target="_blank">'+t+"</a>",n[2]='<a href="'+dle_root+dle_admin+"?mod=blockip&ip="+e+'" target="_blank">'+i+"</a>",n}function ajax_save_for_edit(e,o){var t={};return"2"==quick_wysiwyg&&tinyMCE.triggerSave(),$.each($("#ajaxnews"+e).serializeArray(),function(e,o){t[o.name]=o.value}),t.id=e,t.field=o,t.action="save",t.user_hash=dle_login_hash,ShowLoading(""),$.post(dle_root+"engine/ajax/controller.php?mod=editnews",t,function(e){HideLoading(""),"ok"!=e?DLEalert_new(e,dle_info):($("#dlepopup-news-edit").dialog("close"),DLEconfirm(dle_save_ok,dle_confirm,function(){location.reload(!0)}))}),!1}function ajax_prep_for_edit(d,l){for(var e=0,o=c_cache.length;e<o;e++)e in c_cache&&(!c_cache[e]&&""==c_cache[e]||ajax_cancel_comm_edit(e));return ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=editnews",{id:d,field:l,action:"edit"},function(e){HideLoading("");var t="none";$("#modal-overlay").remove(),$("body").prepend('<div id="modal-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #666666; opacity: .40;filter:Alpha(Opacity=40); z-index: 980; display:none;"></div>'),$("#modal-overlay").css({filter:"alpha(opacity=40)"}).fadeIn();var o={};o[dle_act_lang[3]]=function(){$(this).dialog("close")},o[dle_act_lang[4]]=function(){ajax_save_for_edit(d,l)},$("#dlepopup-news-edit").remove(),$("body").prepend("<div id='dlepopup-news-edit' class='dlepopupnewsedit' title='"+menu_short+"' style='display:none'></div>"),$(".dlepopupnewsedit").html("");var i=.9*$(window).height(),n=.9*$(window).width();1024<n&&(n=1024),$("#dlepopup-news-edit").dialog({autoOpen:!0,width:n,height:i,buttons:o,resizable:!1,dialogClass:"modalfixed dle-popup-quickedit",dragStart:function(e,o){t=$(".modalfixed").css("box-shadow"),$(".modalfixed").css("box-shadow","none")},dragStop:function(e,o){$(".modalfixed").css("box-shadow",t)},close:function(e,o){$(this).dialog("destroy"),$("#modal-overlay").fadeOut(function(){$("#modal-overlay").remove()})}}),830<$(window).width()&&530<$(window).height()&&($(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlepopup-news-edit").dialog("option","position",{my:"center",at:"center",of:window})),$("#dlepopup-news-edit").css({overflow:"auto"}),$("#dlepopup-news-edit").css({"overflow-x":"hidden"}),$("#dlepopup-news-edit").html(e)},"html"),!1}function ajax_cancel_comm_edit(e){return""!=c_cache[e]&&$("#comm-id-"+e).html(c_cache[e]),c_cache[e]="",!1}function MarkSpam(e,o){DLEconfirm(dle_spam_agree,dle_confirm,function(){ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=adminfunction",{id:e,action:"commentsspam",user_hash:o},function(e){HideLoading(""),"error"!=e&&DLEconfirm(e,dle_confirm,function(){location.reload(!0)})})})}function doCalendar(e,o,t){ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=calendar",{month:e,year:o},function(e){HideLoading(""),"left"==t?$("#calendar-layer").hide("slide",{direction:"left"},500,function(){$("#calendar-layer").html(e).show("slide",{direction:"right"},500)}):$("#calendar-layer").hide("slide",{direction:"right"},500,function(){$("#calendar-layer").html(e).show("slide",{direction:"left"},500)})})}function DLESendPM(e){var o={};return $("#dlesendpmpopup").remove(),$("#dleprofilepopup").remove(),o[dle_act_lang[3]]=function(){$(this).dialog("close")},o[dle_p_send]=function(){"2"==dle_wysiwyg&&tinyMCE.triggerSave();var e=$("#pm_subj").val(),o=$("#pm_text").val(),t=$("#pm_name").val(),i=$("#pm_question_answer").val(),n=$("#sec_code_pm").val(),d=$("#outboxcopy:checked").val(),l="";return""==t?DLEalert_new(dle_req_field[0],dle_info):""==o?DLEalert_new(dle_req_field[1],dle_info):""==e?DLEalert_new(dle_req_field[2],dle_info):("1"==dle_captcha_type?"undefined"!=typeof grecaptcha&&(l=grecaptcha.getResponse(recaptcha_widget)):"2"==dle_captcha_type&&(l=$("#pm-recaptcha-response").val()),d=d||0,n=n||"",i=i||"",ShowLoading(""),$.post(dle_root+"engine/ajax/controller.php?mod=pm",{action:"send_pm",subj:e,comments:o,name:t,skin:dle_skin,sec_code:n,question_answer:i,g_recaptcha_response:l,outboxcopy:d,user_hash:dle_login_hash},function(e){var o;HideLoading(""),e.success?($("#dlesendpmpopup").remove(),DLEalert_new(e.success,dle_info)):e.error&&("2"==dle_captcha_type&&"undefined"!=typeof grecaptcha&&(o=$("#pm-recaptcha-response").data("key"),grecaptcha.execute(o,{action:"pm"}).then(function(e){$("#pm-recaptcha-response").val(e)})),DLEalert_new(e.error,dle_info))},"json")),!1},ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=pm",{name:e,action:"show_send",skin:dle_skin,user_hash:dle_login_hash},function(e){HideLoading(""),$("body").append(e),$("#dlesendpmpopup").dialog({autoOpen:!0,width:800,resizable:!1,dialogClass:"modalfixed dle-popup-sendpm",buttons:o}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlesendpmpopup").dialog("option","position",{my:"center",at:"center",of:window})},"html"),!1}function isHistoryApiAvailable(){return!(!window.history||!history.pushState)}function CommentsPage(o,t,i){return ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=comments",{cstart:o,news_id:t,skin:dle_skin},function(e){HideLoading(""),isNaN(o)||isNaN(t)||($("#dle-comm-link").off("click"),$("#dle-comm-link").on("click",function(){return CommentsPage(o,t),!1})),scroll(0,$("#dle-comments-list").offset().top-100),$("#dle-comments-list").html(e.comments),$(".dle-comments-navigation").html(e.navigation),isHistoryApiAvailable()&&window.history.pushState(null,null,i)},"json"),!1}function dle_copy_quote(e){dle_txt="",window.getSelection?dle_txt=window.getSelection().toString():document.selection&&(dle_txt=document.selection.createRange().text.toString()),""!=dle_txt&&(dle_txt="0"==dle_wysiwyg||"-1"==dle_wysiwyg?"[quote="+e+"]"+dle_txt+"[/quote]":(dle_txt=dle_txt.replace(/\n/g,"<br>"),dle_txt=dle_txt.replace(/\r/g,""),"1"==dle_wysiwyg?'<div class="quote_block noncontenteditable"><div class="title_quote">'+dle_quote_title+" "+e+'</div><div class="quote"><div class="quote_body contenteditable">'+dle_txt+"</div></div></div><br>":'<div class="quote_block noncontenteditable"><div class="title_quote">'+dle_quote_title+" "+e+'</div><div class="quote"><div class="quote_body contenteditable">'+dle_txt+"</div></div></div><p><br></p>"))}function dle_fastreply(e){if(!document.getElementById("dle-comments-form"))return!1;var o,t=document.getElementById("dle-comments-form").comments,i="";return"0"==dle_wysiwyg||"-1"==dle_wysiwyg?("0"==dle_wysiwyg?t.value+="[b]"+e+"[/b],\n":t.value+=e+",\n",setTimeout(function(){t.focus()},800),i=".bb-editor"):(o="<div><b>"+e+"</b>,</div><br>",i=".wseditor","1"==dle_wysiwyg?($("#comments").froalaEditor("events.focus"),$("#comments").froalaEditor("html.insert",o,!0)):tinyMCE.execCommand("mceInsertContent",!1,o)),setTimeout(function(){$("html,body").stop().animate({scrollTop:$(i).offset().top-100},700)},100),!1}function dle_ins(e){if(!document.getElementById("dle-comments-form"))return!1;var o=document.getElementById("dle-comments-form").comments,t="",i="";return""!=dle_txt?("0"==dle_wysiwyg||"-1"==dle_wysiwyg?(o.value+=dle_txt+"\n",setTimeout(function(){o.focus()},800),i=".bb-editor"):(t=dle_txt,i=".wseditor","1"==dle_wysiwyg?($("#comments").froalaEditor("events.focus"),$("#comments").froalaEditor("html.insert",t,!0)):tinyMCE.execCommand("mceInsertContent",!1,t)),setTimeout(function(){$("html,body").stop().animate({scrollTop:$(i).offset().top-100},700)},100)):(ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=quote",{id:e,user_hash:dle_login_hash},function(e){HideLoading(""),e=(e=(e=(e=(e=(e=(e=e.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&")).replace(/&quot;/g,'"')).replace(/&#039;/g,"'")).replace(/&#039;/g,"'")).replace(/&#34;/g,'"'),"0"==dle_wysiwyg||"-1"==dle_wysiwyg?(o.value+=e+"\n",setTimeout(function(){o.focus()},800),i=".bb-editor"):(t=e,i=".wseditor","1"==dle_wysiwyg?($("#comments").froalaEditor("events.focus"),$("#comments").froalaEditor("html.insert",t+"<br>",!0)):tinyMCE.execCommand("mceInsertContent",!1,t+"<p><br></p>")),setTimeout(function(){$("html,body").stop().animate({scrollTop:$(i).offset().top-100},700)},100)})),!1}function ckeck_uncheck_all(){for(var e=document.pmlist,o=0;o<e.elements.length;o++){var t=e.elements[o];"checkbox"==t.type&&(1==e.master_box.checked?t.checked=!1:t.checked=!0)}1==e.master_box.checked?e.master_box.checked=!1:e.master_box.checked=!0}function confirmDelete(e){DLEconfirm(dle_del_agree,dle_confirm,function(){document.location=e})}function setNewField(e,o){e!=selField&&(fombj=o,selField=e)}function dle_news_delete(o){var e={};e[dle_act_lang[1]]=function(){$(this).dialog("close")},allow_dle_delete_news&&(e[dle_del_msg]=function(){$(this).dialog("close");var e={};e[dle_act_lang[3]]=function(){$(this).dialog("close")},e[dle_p_send]=function(){var e;$("#dle-promt-text").val().length<1?$("#dle-promt-text").addClass("ui-state-error"):(e=$("#dle-promt-text").val(),$(this).dialog("close"),$("#dlepopup").remove(),$.post(dle_root+"engine/ajax/controller.php?mod=message",{id:o,user_hash:dle_login_hash,text:e},function(e){"ok"==e?document.location=dle_root+"index.php?do=deletenews&id="+o+"&hash="+dle_login_hash:DLEalert_new("Send Error",dle_info)}))},$("#dlepopup").remove(),$("body").append("<div id='dlepopup' class='dle-promt' title='"+dle_notice+"' style='display:none'>"+dle_p_text+"<br /><br /><textarea name='dle-promt-text' id='dle-promt-text' class='ui-widget-content ui-corner-all' style='width:97%;height:100px;'></textarea></div>"),$("#dlepopup").dialog({autoOpen:!0,width:500,resizable:!1,dialogClass:"modalfixed dle-popup-newsdelete",buttons:e}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlepopup").dialog("option","position",{my:"center",at:"center",of:window})}),e[dle_act_lang[0]]=function(){$(this).dialog("close"),document.location=dle_root+"index.php?do=deletenews&id="+o+"&hash="+dle_login_hash},$("#dlepopup").remove(),$("body").append("<div id='dlepopup' class='dle-promt' title='"+dle_confirm+"' style='display:none'><div id='dlepopupmessage'>"+dle_del_agree+"</div></div>"),$("#dlepopup").dialog({autoOpen:!0,width:500,resizable:!1,dialogClass:"modalfixed dle-popup-newsdelete",buttons:e}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlepopup").dialog("option","position",{my:"center",at:"center",of:window})}function MenuNewsBuild(e,o){var t=[];return t[0]="<a onclick=\"ajax_prep_for_edit('"+e+"', '"+o+'\'); return false;" href="#">'+menu_short+"</a>",""!=dle_admin&&(t[1]='<a href="'+dle_root+dle_admin+"?mod=editnews&action=editnews&id="+e+'" target="_blank">'+menu_full+"</a>"),allow_dle_delete_news&&(t[2]="<a onclick=\"sendNotice ('"+e+'\'); return false;" href="#">'+dle_notice+"</a>",t[3]="<a onclick=\"dle_news_delete ('"+e+'\'); return false;" href="#">'+dle_del_news+"</a>"),t}function sendNotice(o){var e={};e[dle_act_lang[3]]=function(){$(this).dialog("close")},e[dle_p_send]=function(){var e;$("#dle-promt-text").val().length<1?$("#dle-promt-text").addClass("ui-state-error"):(e=$("#dle-promt-text").val(),$(this).dialog("close"),$("#dlepopup").remove(),$.post(dle_root+"engine/ajax/controller.php?mod=message",{id:o,user_hash:dle_login_hash,text:e,allowdelete:"no"},function(e){"ok"==e&&DLEalert_new(dle_p_send_ok,dle_info)}))},$("#dlepopup").remove(),$("body").append("<div id='dlepopup' title='"+dle_notice+"' style='display:none'>"+dle_p_text+"<br /><br /><textarea name='dle-promt-text' id='dle-promt-text' class='ui-widget-content ui-corner-all' style='width:97%;height:100px;'></textarea></div>"),$("#dlepopup").dialog({autoOpen:!0,width:500,resizable:!1,dialogClass:"modalfixed dle-popup-sendmessage",buttons:e}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlepopup").dialog("option","position",{my:"center",at:"center",of:window})}function DLEconfirm(e,o,t){var i={};i[dle_act_lang[1]]=function(){$(this).dialog("close"),$("#dlepopup").remove()},i[dle_act_lang[0]]=function(){$(this).dialog("close"),$("#dlepopup").remove(),t&&t()},$("#dlepopup").remove(),$("body").append("<div id='dlepopup' class='dle-confirm' title='"+o+"' style='display:none'>"+e+"</div>"),$("#dlepopup").dialog({autoOpen:!0,width:500,resizable:!1,dialogClass:"modalfixed dle-popup-confirm",buttons:i}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlepopup").dialog("option","position",{my:"center",at:"center",of:window})}function DLEprompt(e,o,t,i,n){var d={};d[dle_act_lang[3]]=function(){$(this).dialog("close")},d[dle_act_lang[2]]=function(){var e;!n&&$("#dle-promt-text").val().length<1?$("#dle-promt-text").addClass("ui-state-error"):(e=$("#dle-promt-text").val(),$(this).dialog("close"),$("#dlepopup").remove(),i&&i(e))},$("#dlepopup").remove(),$("body").append("<div id='dlepopup' class='dle-promt' title='"+t+"' style='display:none'>"+e+"<br /><br /><input type='text' name='dle-promt-text' id='dle-promt-text' class='ui-widget-content ui-corner-all' style='width:97%;' value='"+o+"'/></div>"),$("#dlepopup").dialog({autoOpen:!0,width:500,resizable:!1,dialogClass:"modalfixed dle-popup-promt",buttons:d}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlepopup").dialog("option","position",{my:"center",at:"center",of:window}),(0<o.length?$("#dle-promt-text").select():$("#dle-promt-text")).focus()}var dle_user_profile="",dle_user_profile_link="";function ShowPopupProfile(e,o){var t={};return t[menu_profile]=function(){document.location=dle_user_profile_link},5!=dle_group&&(t[menu_send]=function(){DLESendPM(dle_user_profile)}),1==o&&(t[menu_uedit]=function(){$(this).dialog("close");var e={};return $("body").append('<div id="modal-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #666666; opacity: .40;filter:Alpha(Opacity=40); z-index: 980; display:none;"></div>'),$("#modal-overlay").css({filter:"alpha(opacity=40)"}).fadeIn("slow"),$("#dleuserpopup").remove(),$("body").append("<div id='dleuserpopup' title='"+menu_uedit+"' style='display:none'></div>"),e[dle_act_lang[3]]=function(){$(this).dialog("close"),$("#dleuserpopup").remove()},e[dle_act_lang[5]]=function(){window.frames.edituserframe.confirmDelete(dle_login_hash)},e[dle_act_lang[4]]=function(){document.getElementById("edituserframe").contentWindow.document.getElementById("saveuserform").submit()},$("#dleuserpopup").dialog({autoOpen:!0,width:700,resizable:!1,dialogClass:"modalfixed dle-popup-userprofileadmin",buttons:e,open:function(e,o){$("#dleuserpopup").html("<iframe name='edituserframe' id='edituserframe' width='100%' height='400' src='"+dle_root+dle_admin+"?mod=editusers&action=edituser&user="+dle_user_profile+"&skin="+dle_skin+"' frameborder='0' marginwidth='0' marginheight='0' allowtransparency='true'></iframe>")},beforeClose:function(e,o){$("#dleuserpopup").html("")},close:function(e,o){$("#modal-overlay").fadeOut("slow",function(){$("#modal-overlay").remove()})}}),830<$(window).width()&&530<$(window).height()&&($(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dleuserpopup").dialog("option","position",{my:"center",at:"center",of:window})),!1}),$("#dleprofilepopup").remove(),$("body").append(e),$("#dleprofilepopup").dialog({autoOpen:!0,resizable:!1,dialogClass:"dle-popup-userprofile",buttons:t,width:550}),!1}function ShowProfile(e,o,t){return dle_user_profile==e&&document.getElementById("dleprofilepopup")?$("#dleprofilepopup").dialog("open"):(dle_user_profile=e,dle_user_profile_link=o,ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=profile",{name:e,skin:dle_skin,user_hash:dle_login_hash},function(e){HideLoading(""),ShowPopupProfile(e,t)})),!1}function ShowLoading(e="",o="center",t="center"){let i="";$("#loading-layer").remove(),0!==e.length&&e.trim()?(i="withtext",e="<span>"+e+"</span>"):(e='<svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.0" width="32px" height="32px" viewBox="0 0 128 128" xml:space="preserve"><g><path fill="#ffffff" d="M64,128a64,64,0,1,1,64-64A64,64,0,0,1,64,128ZM64,2.75A61.25,61.25,0,1,0,125.25,64,61.25,61.25,0,0,0,64,2.75Z"/><path fill="#ffffff" d="M64 128a64 64 0 1 1 64-64 64 64 0 0 1-64 64zM64 2.75A61.2 61.2 0 0 0 3.34 72.4c1.28-3.52 3.9-6.32 7.5-6.86 6.55-1 11.9 2.63 13.6 8.08 3.52 11.27.5 23 15 35.25 19.47 16.46 40.34 13.54 52.84 9.46A61.25 61.25 0 0 0 64 2.75z"/><animateTransform attributeName="transform" type="rotate" from="0 64 64" to="360 64 64" dur="1400ms" repeatCount="indefinite"></animateTransform></g></svg>',i="withouttext"),$("body").append('<div id="loading-layer" class="'+i+'" style="display:none">'+e+"</div>");var n=($(window).width()-$("#loading-layer").outerWidth())/2,d=($(window).height()-$("#loading-layer").outerHeight())/2;switch(o){case"left":n=15;break;case"right":n=$(window).width()-$("#loading-layer").outerWidth()-15}switch(t){case"top":d=15;break;case"bottom":d=$(window).height()-$("#loading-layer").outerHeight()-15}$("#loading-layer").css({left:n+"px",top:d+"px",position:"fixed",zIndex:"9999"}),$("#loading-layer").fadeTo("slow",1)}function HideLoading(e){$("#loading-layer").fadeOut("slow",function(){$("#loading-layer").remove()})}function ShowAllVotes(){return document.getElementById("dlevotespopup")?$("#dlevotespopup").dialog("open"):($.ajaxSetup({cache:!1}),ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=allvotes&dle_skin="+dle_skin,function(e){HideLoading(""),$("#dlevotespopup").remove(),$("body").append(e),$(".dlevotebutton").button(),$("#dlevotespopup").dialog({autoOpen:!0,resizable:!1,dialogClass:"dle-popup-allvotes",width:600}),400<$("#dlevotespopupcontent").height()&&$("#dlevotespopupcontent").height(400),$("#dlevotespopup").dialog("option","height",$("#dlevotespopupcontent").height()+60),$("#dlevotespopup").dialog("option","position","center")})),!1}function fast_vote(o){var e=$("#vote_"+o+" input:radio[name=vote_check]:checked").val();return void 0===e||(ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=vote",{vote_id:o,vote_action:"vote",vote_mode:"fast_vote",vote_check:e,dle_skin:dle_skin,user_hash:dle_login_hash},function(e){HideLoading(""),$("#dle-vote_list-"+o).fadeOut(500,function(){$(this).html(e),$(this).fadeIn(500)})})),!1}function AddIgnorePM(e,o){DLEconfirm(o,dle_confirm,function(){ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=pm",{id:e,action:"add_ignore",skin:dle_skin,user_hash:dle_login_hash},function(e){return HideLoading(""),DLEalert_new(e,dle_info),!1})})}function DelIgnorePM(o,e){return DLEconfirm(e,dle_confirm,function(){ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=pm",{id:o,action:"del_ignore",skin:dle_skin,user_hash:dle_login_hash},function(e){return HideLoading(""),$("#dle-ignore-list-"+o).html(""),DLEalert_new(e,dle_info),!1})}),!1}function DelSocial(o,e){return DLEconfirm(e,dle_confirm,function(){ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=adminfunction",{id:o,action:"del_social",user_hash:dle_login_hash},function(e){return HideLoading(""),$("#dle-social-list-"+o).html(""),DLEalert_new(e,dle_info),!1})}),!1}function subscribe(e){return DLEconfirm(dle_sub_agree,dle_confirm,function(){ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=commentssubscribe",{news_id:e,skin:dle_skin,user_hash:dle_login_hash},function(e){HideLoading(""),e.success?DLEalert_new(e.info,dle_info):e.error&&DLEalert_new(e.errorinfo,dle_info)},"json")}),!1}var media_upload_manager=!1;function media_upload(e,o,t,i){var n="none",d=e+o+t+i;return $("#mediaupload").hasClass("ui-dialog-content")&&media_upload_manager==d?($("#mediaupload").dialog("open"),check_all()):($("#mediaupload").remove(),$("body").append("<div id='mediaupload' class='mediaupload-body' title='"+text_upload+"' style='display:none'></div>"),ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php",{mod:"upload",area:e,news_id:t,author:o,wysiwyg:i},function(e){HideLoading(""),$("#mediaupload").html(e);var o=.9*$(window).height(),e=.9*$(window).width();810<e&&(e=810),600<o&&(o=600),$("#mediaupload").dialog({autoOpen:!0,width:e,height:o,resizable:!1,dialogClass:"modalfixed dle-popup-mediaupload",open:function(e,o){$(".dle-popup-mediaupload").append($("#mediaupload-buttonpane").html()),$("#mediaupload-buttonpane").remove()},dragStart:function(e,o){n=$(".modalfixed").css("box-shadow"),$(".modalfixed").fadeTo(0,.7).css("box-shadow","none"),$("#mediaupload").css("visibility","hidden")},dragStop:function(e,o){$(".modalfixed").fadeTo(0,1).css("box-shadow",n),$("#mediaupload").css("visibility","visible")}}),media_upload_manager=d,830<$(window).width()&&530<$(window).height()&&($(".modalfixed.ui-dialog").css({position:"fixed"}),$("#mediaupload").dialog("option","position",{my:"center",at:"center",of:window}))},"html")),!1}function dropdownmenu(e,o,t,i){window.event?event.cancelBubble=!0:o.stopPropagation&&o.stopPropagation();o=$("#dropmenudiv");if(o.is(":visible"))return clearhidemenu(),o.fadeOut("fast"),!1;o.remove(),$("body").append('<div id="dropmenudiv" style="display:none;position:absolute;z-index:100;width:165px;"></div>'),(o=$("#dropmenudiv")).html(t.join("")),i&&o.width(i);t=$(document).width()-30,i=$(e).offset();return t-i.left<o.width()&&(i.left=i.left-(o.width()-$(e).width())),o.css({left:i.left+"px",top:i.top+$(e).height()+"px"}),o.fadeTo("fast",.9),o.mouseenter(function(){clearhidemenu()}).mouseleave(function(){delayhidemenu()}),$(document).one("click",function(){hidemenu()}),!1}function setcookie(e,o){var t=new Date;t.setTime(t.getTime()+26784e5);t="expires="+t.toUTCString();document.cookie=e+"="+o+";"+t+";path=/"}function get_local_storage(e){try{return localStorage.getItem(e)?JSON.parse(localStorage.getItem(e)):null}catch(e){return null}}function set_local_storage(e,o){try{localStorage.setItem(e,JSON.stringify(o))}catch(e){}}function del_local_storage(e,o){try{localStorage.removeItem(e)}catch(e){}}function save_last_viewed(e){if(e=parseInt(e),isNaN(e))return null;var o=get_local_storage("viewed_ids");return $.isArray(o)?-1==$.inArray(e,o)&&(19<o.length&&o.pop(),o.unshift(e)):(o=[]).push(e),set_local_storage("viewed_ids",o),setcookie("viewed_ids",o.join()),!0}function hidemenu(e){$("#dropmenudiv").fadeOut("fast")}function delayhidemenu(){delayhide=setTimeout("hidemenu()",1e3)}function clearhidemenu(){"undefined"!=typeof delayhide&&clearTimeout(delayhide)}jQuery(function(i){var t=!1,e=new Array,n="";setTimeout(function(){i("img[data-maxwidth]").each(function(){var e=i(this).width(),o=i(this).data("maxwidth");i(this)[0].naturalWidth&&(e=i(this)[0].naturalWidth),o<e&&(i(this).width(o),i(this).wrap('<a href="'+i(this).attr("src")+'" onclick="return hs.expand(this)"></a>'),"undefined"==typeof hs&&0==t&&(t=!0,i.getCachedScript(dle_root+"engine/classes/highslide/highslide.js").done(function(){hs.graphicsDir=dle_root+"engine/classes/highslide/graphics/",hs.numberOfImagesToPreload=0,hs.captionEval="this.thumb.alt",hs.showCredits=!1,hs.align="center",hs.transitions=["expand","crossfade"]})))})},300),setTimeout(function(){i("div[data-dlebclicks]").each(function(){var e=i(this).data("dlebid");i(this).find("a").on("click",function(){i.post(dle_root+"engine/ajax/controller.php?mod=adminfunction",{id:e,action:"bannersclick",user_hash:dle_login_hash})})})},400),i("div[data-dlebviews]").each(function(){e.push(i(this).data("dlebid"))}),e.length&&setTimeout(function(){i.post(dle_root+"engine/ajax/controller.php?mod=adminfunction",{"ids[]":e,action:"bannersviews",user_hash:dle_login_hash})},1e3)}),jQuery.getCachedScript=function(e,o){return o=$.extend(o||{},{dataType:"script",cache:!0,url:e}),jQuery.ajax(o)};if(window.innerWidth>1560){let wasPast500=!1;window.addEventListener("scroll",()=>{const scrollY=window.scrollY;if(!wasPast500&&scrollY>=500){wasPast500=!0;$('.btns-desc').fadeOut(200)}
if(wasPast500&&scrollY<500){wasPast500=!1;$('.btns-desc').fadeIn(200)}})}
$('#dle-comments-form').submit(function(){doNewAddComments();return!1});function FastNewSearch(){$('#story').attr('autocomplete','off');$('#story').keyup(function(){var inputString=$(this).val(),category=$(this).parent().find('input:checked').val();if(!category)category=0;if(inputString.length==0){$('#searchsuggestions').fadeOut()}else{if(dle_search_value!=inputString&&inputString.length>=dle_min_search){clearInterval(dle_search_delay);dle_search_delay=setInterval(function(){dle_new_do_search(inputString,category)},600)}}});$(".q-search-cats label").on("click",function(){var inputString=$('#story').val();id='#'+$(this).attr('for');if($(id).is(':checked')){category=0}else{category=$(id).val()}
if(inputString.length>3){dle_new_do_search(inputString,category)}})};FastNewSearch()